<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>公文</title>
    <link rel="stylesheet" href="//at.alicdn.com/t/font_nlmrc8a79w20ggb9.css">
    <script src="/resource/new_js/jquery.js"></script>
    <link rel="stylesheet" href="/resource/new_css/amazeui.min.css">
    <link rel="stylesheet" href="/resource/new_css/doc_index.css">
    <script src="/resource/new_js/amazeui.js"></script>
    <script src="/resource/new_js/doc_index.js"></script>
    <style>
        .search-cover{
            display: block;
            top: 2px;
            border: none;
            background: none;
        }
    </style>
</head>
<body>
{include file="../../layout/view/base/index_header" /}
<!--主体内容-->
<div class="ibody">
    <div class="ibody-header">
        <h2 style="font-weight: 500">公文</h2>
        <div class="mtw">
            <span>{$date_lunar}</span>
        </div>
    </div>
    <div class="icontainer">
        <div class="aside-left">
            <ul>
                <li class="li-big">
                    <span class="iconfont" style="font-size: 18px;font-weight: 600">&#xe639;</span>

                    <a href="{:url('doc/index',['type'=>1])}">未签收</a>
                    <span class="show-span">{$no_sign}</span>
                </li>
                <li class="li-big li-big-active">
                    <span class="iconfont" style="font-size: 18px;font-weight: 600;color: #3497db;">&#xe637;</span>
                    <a href="" style="color: #3497db;">公文</a>
                </li>
                <li class="li-small">
                    <span class="iconfont">&#xe6b7;</span>
                    <a href="">下发公文</a>
                </li>
                <li class="li-small">
                    <span class="iconfont">&#xe6b7;</span>
                    <a href="">上报公文</a>
                </li>
            </ul>
        </div>
        <div class="aside-right">
            {switch name="type_name" }
            {case value="未签收"}
                    <div class="doc_nav">
                        <ul>
                            <li>
                                <a href="{:url('doc/index',['type'=>0])}">
                                    <span class="iconfont">&#xe625;</span>全部
                                </a>
                            </li>
                            <li style="position: relative">
                                <a href="{:url('doc/index',['type'=>1])}" class="active">
                                <span class="iconfont">&#xe644;</span>未签收
                                <span class="show-span" style="position:absolute;display:inline-block;width:35px;height:20px;top:0px;z-index:10;background-color:#E25050;right: 5px;padding-left: 8px">{$no_sign}</span></a>
                            </li>
                            <li style="position: relative">
                                <a href="{:url('doc/index',['type'=>2])}">
                                <span class="iconfont">&#xea4a;</span>签收
                                {neq name="sign_count" value="0"}
                                  <span class="show-span" style="position:absolute;display:inline-block;width:35px;height:20px;top:0px;z-index:10;background-color:#E25050;right: 5px;padding-left: 8px">{$sign_count}</span>
                                  {else/}
                                {/neq}
                                </a>
                            </li>
                            <li><a href="{:url('doc/index',['type'=>3])}">
                                <span class="iconfont">&#xe642;</span>待审核</a>
                            </li>
                            <li><a href="{:url('doc/index',['type'=>4])}">
                                <span class="iconfont">&#xe625;</span>草稿</a>
                            </li>
                        </ul>
                   </div>
                     <div class="page-list-header">
                         <a href="{:url('doc/add_doc')}" style="color: white;font-size: 14px;">
                             <button type="button" class="am-btn am-btn-primary" style="float: left;margin: 0 10px;font-size: 14px">
                               起草公文
                            </button>
                         </a>
                            <div class="am-dropdown" data-am-dropdown style="float:left">
                                <button class="am-btn am-btn-default am-dropdown-toggle button-left">
                                    更多操作
                                    <span class="iconfont" style="font-size:10px">&#xe659;</span>
                                </button>
                                <ul class="am-dropdown-content">
                                    <li>
                                        <a href="#" class="dialog_del"><span class="iconfont" style="display: inline-block;margin-right: 10px;font-size:13px;">&#xe61b;</span>删除</a>
                                    </li>
                                </ul>
                            </div>
                            <div class="search-box">
                                <form action="" method="get">
                                    <span class="iconfont">&#xe67a;</span>
                                    <div style="float: left;">
                                        <input type="text" name="title" class="am-form-field am-round  article-search" placeholder="输入标题查询"/>
                                        <a class="iconfont shezhi" style="display: none;font-size: 28px">&#xe604;</a>
                                        <button class="iconfont search-cover" style="font-size: 32px">&#xe64b;</button>
                                    </div>
                                </form>
                            </div>
                        </div>
            {/case}
            {case value="签收"}
                                <div class="doc_nav">
                                    <ul>
                                        <li>
                                            <a href="{:url('doc/index',['type'=>0])}">
                                                <span class="iconfont">&#xe625;</span>全部
                                            </a>
                                        </li>
                                        <li style="position: relative">
                                            <a href="{:url('doc/index',['type'=>1])}">
                                                <span class="iconfont">&#xe644;</span>未签收
                                                <span class="show-span" style="position:absolute;display:inline-block;width:35px;height:20px;top:0px;z-index:10;background-color:#E25050;right: 5px;padding-left: 8px">{$no_sign}</span></a>
                                        </li>
                                        <li style="position: relative">
                                            <a href="{:url('doc/index',['type'=>2])}"  class="active">
                                                <span class="iconfont">&#xea4a;</span>签收
                                                {neq name="sign_count" value="0"}
                                                <span class="show-span" style="position:absolute;display:inline-block;width:35px;height:20px;top:0px;z-index:10;background-color:#E25050;right: 5px;padding-left: 8px">{$sign_count}</span>
                                                {else/}
                                                {/neq}</a>
                                        </li>
                                        <li><a href="{:url('doc/index',['type'=>3])}">
                                            <span class="iconfont">&#xe642;</span>待审核</a>
                                        </li>
                                        <li><a href="{:url('doc/index',['type'=>4])}">
                                            <span class="iconfont">&#xe625;</span>草稿</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="page-list-header">
                                    <a href="{:url('doc/add_doc')}" style="color: white;font-size: 14px;">
                                        <button type="button" class="am-btn am-btn-primary" style="float: left;margin: 0 10px;font-size: 14px">
                                            起草公文
                                        </button>
                                    </a>
                                    <div class="am-dropdown" data-am-dropdown style="float:left">
                                        <button class="am-btn am-btn-default am-dropdown-toggle button-left">
                                            更多操作
                                            <span class="iconfont" style="font-size:10px">&#xe659;</span>
                                        </button>
                                        <ul class="am-dropdown-content">

                                            <li>
                                                <a href="#" class="dialog_del"><span class="iconfont" style="display: inline-block;margin-right: 10px;font-size:13px;">&#xe61b;</span>删除</a>
                                            </li>
                                        </ul>
                                    </div>
                                    <div class="search-box">
                                        <form action="" method="get">
                                            <span class="iconfont">&#xe67a;</span>
                                            <div style="float: left;">
                                                <input type="text" name="title" class="am-form-field am-round  article-search" placeholder="输入标题查询"/>
                                                <a class="iconfont shezhi" style="display: none;font-size: 28px">&#xe604;</a>
                                                <button class="iconfont search-cover" style="font-size: 32px">&#xe64b;</button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
            {/case}
            {case value="待审核"}
                            <div class="doc_nav">
                                <ul>
                                    <li>
                                        <a href="{:url('doc/index',['type'=>0])}">
                                            <span class="iconfont">&#xe625;</span>全部
                                        </a>
                                    </li>
                                    <li style="position: relative">
                                        <a href="{:url('doc/index',['type'=>1])}">
                                            <span class="iconfont">&#xe644;</span>未签收
                                            <span class="show-span" style="position:absolute;display:inline-block;width:35px;height:20px;top:0px;z-index:10;background-color:#E25050;right: 5px;padding-left: 8px">{$no_sign}</span></a>
                                    </li>
                                    <li style="position: relative">
                                        <a href="{:url('doc/index',['type'=>2])}">
                                            <span class="iconfont">&#xea4a;</span>签收
                                            {neq name="sign_count" value="0"}
                                            <span class="show-span" style="position:absolute;display:inline-block;width:35px;height:20px;top:0px;z-index:10;background-color:#E25050;right: 5px;padding-left: 8px">{$sign_count}</span>
                                            {else/}
                                            {/neq}
                                        </a>
                                    </li>
                                    <li><a href="{:url('doc/index',['type'=>3])}"  class="active">
                                        <span class="iconfont">&#xe642;</span>待审核</a>
                                    </li>
                                    <li><a href="{:url('doc/index',['type'=>4])}">
                                        <span class="iconfont">&#xe625;</span>草稿</a>
                                    </li>
                                </ul>
                            </div>
                            <div class="page-list-header">
                                <button type="button" class="am-btn am-btn-primary" style="float: left;margin: 0 10px">
                                    <a href="" style="color: white;font-size: 14px;">审核通过</a>
                                </button>
                                <button type="button" class="am-btn am-btn-default" style="float: left;margin: 0 10px;">
                                    <a href="" style="color: white;font-size: 14px;color: #82939E;">退回</a>
                                </button>
                                <div class="am-dropdown" data-am-dropdown style="float:left">
                                    <button class="am-btn am-btn-default am-dropdown-toggle button-left">
                                        更多操作
                                        <span class="iconfont" style="font-size:10px">&#xe659;</span>
                                    </button>
                                    <ul class="am-dropdown-content">
                                        <li>
                                            <a href="#" class="dialog_del"><span class="iconfont" style="display: inline-block;margin-right: 10px;font-size:13px;">&#xe61b;</span>删除</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="search-box">
                                    <form action="" method="get">
                                        <span class="iconfont">&#xe67a;</span>
                                        <div style="float: left;">
                                            <input type="text" name="title" class="am-form-field am-round  article-search" placeholder="输入标题查询"/>
                                            <a class="iconfont shezhi" style="display: none;font-size: 28px">&#xe604;</a>
                                            <button class="iconfont search-cover" style="font-size: 32px">&#xe64b;</button>
                                        </div>
                                    </form>
                                </div>
                            </div>
            {/case}
            {case value="草稿"}
                                <div class="doc_nav">
                                    <ul>
                                        <li>
                                            <a href="{:url('doc/index',['type'=>0])}">
                                                <span class="iconfont">&#xe625;</span>全部
                                            </a>
                                        </li>
                                        <li style="position: relative">
                                            <a href="{:url('doc/index',['type'=>1])}">
                                                <span class="iconfont">&#xe644;</span>未签收
                                                <span class="show-span" style="position:absolute;display:inline-block;width:35px;height:20px;top:0px;z-index:10;background-color:#E25050;right: 5px;padding-left: 8px">{$no_sign}</span></a>
                                        </li>
                                        <li style="position: relative">
                                            <a href="{:url('doc/index',['type'=>2])}">
                                                <span class="iconfont">&#xea4a;</span>签收
                                                {neq name="sign_count" value="0"}
                                                <span class="show-span" style="position:absolute;display:inline-block;width:35px;height:20px;top:0px;z-index:10;background-color:#E25050;right: 5px;padding-left: 8px">{$sign_count}</span>
                                                {else/}
                                                {/neq}
                                            </a>
                                        </li>
                                        <li><a href="{:url('doc/index',['type'=>3])}">
                                            <span class="iconfont">&#xe642;</span>待审核</a>
                                        </li>
                                        <li><a href="{:url('doc/index',['type'=>4])}"  class="active">
                                            <span class="iconfont">&#xe625;</span>草稿</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="page-list-header">
                                    <a href="{:url('doc/add_doc')}" style="color: white;font-size: 14px;">
                                        <button type="button" class="am-btn am-btn-primary" style="float: left;margin: 0 10px;font-size: 14px">
                                           起草公文
                                        </button>
                                    </a>
                                    <div class="am-dropdown" data-am-dropdown style="float:left">
                                        <button class="am-btn am-btn-default am-dropdown-toggle button-left">
                                            更多操作
                                            <span class="iconfont" style="font-size:10px">&#xe659;</span>
                                        </button>
                                        <ul class="am-dropdown-content">

                                            <li>
                                                <a href="#" class="dialog_del"><span class="iconfont" style="display: inline-block;margin-right: 10px;font-size:13px;">&#xe61b;</span>删除</a>
                                            </li>
                                        </ul>
                                    </div>
                                    <div class="search-box">
                                        <form action="" method="get">
                                            <span class="iconfont">&#xe67a;</span>
                                            <div style="float: left;">
                                                <input type="text" name="title" class="am-form-field am-round  article-search" placeholder="输入标题查询"/>
                                                <a class="iconfont shezhi" style="display: none;font-size: 28px">&#xe604;</a>
                                                <button class="iconfont search-cover" style="font-size: 32px">&#xe64b;</button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
            {/case}
            {default /}
                                    <div class="doc_nav">
                                        <ul>
                                            <li>
                                                <a href="{:url('doc/index',['type'=>0])}"  class="active">
                                                    <span class="iconfont">&#xe625;</span>全部
                                                </a>
                                            </li>
                                            <li style="position: relative">
                                                <a href="{:url('doc/index',['type'=>1])}">
                                                    <span class="iconfont">&#xe644;</span>未签收
                                                    <span class="show-span" style="position:absolute;display:inline-block;width:35px;height:20px;top:0px;z-index:10;background-color:#E25050;right: 5px;padding-left: 8px">{$no_sign}</span></a>
                                            </li>
                                            <li style="position: relative">
                                                <a href="{:url('doc/index',['type'=>2])}">
                                                    <span class="iconfont">&#xea4a;</span>签收
                                                    {neq name="sign_count" value="0"}
                                                    <span class="show-span" style="position:absolute;display:inline-block;width:35px;height:20px;top:0px;z-index:10;background-color:#E25050;right: 5px;padding-left: 8px">{$sign_count}</span>
                                                    {else/}
                                                    {/neq}
                                                </a>
                                            </li>
                                            <li><a href="{:url('doc/index',['type'=>3])}">
                                                <span class="iconfont">&#xe642;</span>待审核</a>
                                            </li>
                                            <li><a href="{:url('doc/index',['type'=>4])}">
                                                <span class="iconfont">&#xe625;</span>草稿</a>
                                            </li>
                                        </ul>
                                    </div>
                                    <div class="page-list-header">
                                        <a href="{:url('doc/add_doc')}" style="color: white;font-size: 14px;">
                                            <button type="button" class="am-btn am-btn-primary" style="float: left;margin: 0 10px;font-size: 14px">
                                               起草公文
                                            </button>
                                        </a>
                                    <div class="am-dropdown" data-am-dropdown style="float:left">
                                        <button class="am-btn am-btn-default am-dropdown-toggle button-left">
                                            更多操作
                                            <span class="iconfont" style="font-size:10px">&#xe659;</span>
                                        </button>
                                        <ul class="am-dropdown-content">
                                            <li>
                                                <a href="#" class="dialog_del"><span class="iconfont" style="display: inline-block;margin-right: 10px;font-size:13px;">&#xe61b;</span>删除</a>
                                            </li>
                                        </ul>
                                    </div>
                                    <div class="search-box">
                                        <form action="" method="get">
                                            <span class="iconfont">&#xe67a;</span>
                                            <div style="float: left;">
                                                <input type="text" name="title" class="am-form-field am-round  article-search" placeholder="输入标题查询"/>
                                                <a class="iconfont shezhi" style="display: none;font-size: 28px">&#xe604;</a>
                                                <button class="iconfont search-cover" style="font-size: 32px">&#xe64b;</button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
            {/switch}
            <div class="page-table" style="position: relative">
                <div style="position: absolute;width:780px;height: 500px;top: 0px;left: 0px;padding:90px 200px;display: none" class="table-pic">
                    <img src="/resource/img/no-info.png" alt="">
                </div>
                <table class="am-table am-table-striped am-table-hover">
                    <tr height="40px" style="color:#3497db;background-color: darkblue;">
                        <th style="width: 50px;padding-left: 22px;background-color: #f9f9f6;">
                            <input type="checkbox" style="height: 20px; width: 20px;" id="checkall"/>
                        </th>
                        <th style="width: 60px;background-color: #f9f9f6;padding-left:15px;">
                            <span class=" iconfont" style="font-size:16px;">&#xe6db;</span>
                        </th>
                        <th style="width: 434px;background-color: #f9f9f6;font-weight: 400">
                            标题
                        </th>
                        <th style="width: 140px;background-color: #f9f9f6;font-weight: 400">
                            发布者
                        </th>
                        <th style="background-color: #f9f9f6;font-weight: 400">
                            <span>已签收</span>
                        </th>
                    </tr>
                    {volist name="doc_list" id="vo"}
                    <tr height="60px" class="del-tr">
                        <th style="width: 50px;padding-left: 22px;padding-top: 20px;">
                            <input type="checkbox" data-id="{$vo.doc_id}" style="height: 20px; width: 20px;"/>
                        </th>
                        <th style="width: 60px;padding:8px 0 0 15px">
                            <span class=" iconfont" style="font-size:30px;font-weight: 300;">&#xe699;</span>
                        </th>
                        <th style="width: 434px;padding-top:20px">
                            <a href="{:url('detail',['doc_id'=>$vo['doc_id']])}" style="font-size: 14px; font-weight: 400;" class="table-a">{$vo.doc_title}</a>
                        </th>
                        <th style="width: 140px;font-size: 14px; font-weight: 400;">
                            <span style="font-size: 12px;color:#82939E ;">{$vo.user_real_name}</span>
                            <span style="font-size: 12px;color:#82939E ;">{$vo.doc_user_id}</span>
                            <span style="display: block;font-size: 12px;color: #B2C0D1">{$vo.doc_time|date="Y/m/d H:i:s",###}</span>
                        </th>
                        <th style="position: relative;">
                            <span style="font-size: 14px; font-weight: 400;display: inline-block;margin-top: 15px;" class="table-number">{$vo.no_sign}</span>
                            {eq name="is_super" value="1"}
                                <div class="table-edit" style="width:80px;height: 30px;z-index:5;position:absolute;top:18px;left:-5px;display: none;">
                                    <a class="iconfont table-edit-left" data-id="{$vo.doc_id}" data-url="{:url('doc/edit_doc',['doc_id'=>$vo.doc_id])}">&#xe605;</a>
                                    <a class="iconfont table-edit-right" data-id="{$vo.doc_id}">&#xe61b;</a>
                                </div>
                                {else/}
                                    {eq name="user_id" value="$vo.doc_user_id"}
                                    <div class="table-edit" style="width:80px; height: 30px;;z-index: 5;position: absolute;top: 18px;left:-5px;display: none;">
                                        <a class="iconfont table-edit-left" data-id="{$vo.doc_id}" data-url="{:url('doc/edit_doc',['doc_id'=>$vo.doc_id])}">&#xe605;</a>
                                        <a class="iconfont table-edit-right" data-id="{$vo.doc_id}">&#xe61b;</a>
                                    </div>
                                    {/eq}
                            {/eq}
                        </th>
                    </tr>
                    {/volist}
                </table>
            </div>
            <div class="page-list">
               {$doc_list->render()}
            </div>
        </div>
        <div style="clear: both;"></div>
    </div>
    <div class="footer">
        <a href="{:url('index/index')}"><i class="footer-logo"></i></a>
        <a href="">信息中心</a>
        <a href="{:url('doc/index')}">公文</a>
        <a href="">公文列表</a>
    </div>
</div>
<!--高级设计弹出框-->
<div class="set-dialog">
    <div class="dialog-title">
        高级设置
        <a class="dialog-close">&times;</a>
    </div>
    <div class="dialog-content">
        <form action="{:url('')}" method="post">
            <div class="control-group">
                <label for="">关键字</label>
                <input type="text">
            </div>
            <div class="control-group">
                <div class="am-input-group am-datepicker-date" data-am-datepicker="{format: 'dd-mm-yyyy'}" style="position: relative">
                    <label for="">开始时间</label>
                    <input type="text" class="am-form-field" style="margin-left: 10px;border-radius: 4px; width: 300px; display: inline-block;">
                  <span class="am-input-group-btn am-datepicker-add-on">
                    <button class="am-btn am-btn-default" type="button" style=" position: absolute;z-index: 10; top: 0px;right: 2px;height: 40px;">
                        <span class="am-icon-calendar"></span>
                    </button>
                  </span>
                </div>
            </div>
            <div class="control-group">
                <div class="am-input-group am-datepicker-date" data-am-datepicker="{format: 'dd-mm-yyyy'}" style="position: relative">
                    <label for="">结束时间</label>
                    <input type="text" class="am-form-field" style="margin-left: 10px;border-radius: 4px; width: 300px; display: inline-block;">
                  <span class="am-input-group-btn am-datepicker-add-on">
                    <button class="am-btn am-btn-default" type="button" style=" position: absolute;z-index: 10; top: 0px;right: 2px;height: 40px;">
                        <span class="am-icon-calendar"></span>
                    </button>
                  </span>
                </div>
            </div>
        </form>
    </div>
    <div class="dialog-button">
        <button type="button" class="am-btn am-btn-default">取消</button>
        <button type="button" class="am-btn am-btn-primary">确定</button>
    </div>
</div>
<!--遮罩层-->
<div class="mask" style="display: none">
    <div class="edit-mask">
        <ul class="mask-panel">
            <li style="height:90px;padding-top: 30px;text-align: center">
                修改后可能需要重新审核
            </li>
            <li style="padding-left:150px">
                <button style="height: 30px;padding-top: 5px" class="am-btn am-btn-default mask-close">取消</button>

                <button style="height: 30px;padding-top: 5px" class="am-btn am-btn-primary mask-edit-sure">确定</button>

            </li>
        </ul>
    </div>
    <div class="del-mask">
        <ul class="mask-panel">
            <li style="height:90px;padding: 30px 0 0 80px">
                确认要删除选中的公文吗？该操作<br>无法恢复
            </li>
            <li style="padding-left:150px">
                <button style="height: 30px;padding-top: 5px" class="am-btn am-btn-default mask-close">取消</button>
                <form action="{:url('doc/delete_doc')}" method="post" style="display: inline-block" id="del_form">
                    <input type="hidden" name="doc_id" value="" id="del-input">
                    <button style="height: 30px;padding-top: 5px" class="am-btn am-btn-primary mask-close delete-sure">确定</button>
                </form>
            </li>
        </ul>
    </div>
</div>
<script>
//更多操作的删除
    $(".dialog_del").click(function(){
        $(".mask").css("display","block");
        $(".edit-mask").css("display","none");
        $(".del-mask").css("display","block");
        var id=$(".am-table").find("tr").find("input:checked").data("id");
        console.log(id);
        if(typeof(id) != "undefined" && id != null){
            $(".edit-mask").data("id",id);
        };
    });

    //编辑页跳转
    $(".mask-edit-sure").on("click",function(){
        var doc_id = $(".edit-mask").data("id");
        if(typeof(doc_id) != "undefined" && doc_id != null){
            var url = $("[data-id="+doc_id+"]").data("url");
        }
        window.location.href = url;
    });
//    删除页
    $(".table-edit-right").click(function(){
        var id = $(this).data("id");
        if(typeof(id) != "undefined" && id != null){
            $(".edit-mask").data("id",id);
         }
    });
    $(".delete-sure").on("click",function(){
        var doc_id = $(".edit-mask").data("id");
        $("#del-input").val(doc_id);
        $("#del_form").submit();
    });
//没有信息时显示图片
        var tr_len=$(".page-table").find("tr").length;
          if(tr_len==1){
              $(".table-pic").css("display","block")
          }

</script>
</body>
</html>