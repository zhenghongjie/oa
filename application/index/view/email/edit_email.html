<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>转发邮件</title>
    <link rel="stylesheet" href="//at.alicdn.com/t/font_bqphh0tc2haaif6r.css"/>
    <link rel="stylesheet" href="/resource/new_css/amazeui.min.css"/>
    <link rel="stylesheet" href="/resource/new_css/add_email.css"/>
    <script src="/resource/new_js/jquery.js"></script>
    <script src="/resource/new_js/amazeui.js"></script>
    <script type="text/javascript" src="/resource/new_js/add_doc.js"></script>
    <script type="text/javascript" src="/resource/new_js/add_email.js"></script>
</head>
<body>
{include file="../../layout/view/base/index_header" /}
<!--主体内容-->
<div class="ibcontainer">
    <div class="ibcontainer_date">
        <div class="date">
            <span style="display: inline-block;float: left;font-size: 20px;font-weight: 500;">填写邮件</span>
            <span style="display: inline-block;float: right;">{$date_lunar}</span>
        </div>
    </div>
    <div class="ibcontainer_body">
        <div class="aside-left">
            <div class="aside-left-top">
                <button type="button" class="am-btn am-btn-warning" id="yellow-button">
                    <div style="margin-top: -3px;">
                        <span class="iconfont" style="font-size:20px;">&#xe605;</span>
                        <span style="font-size: 14px;">写邮件</span>
                    </div>
                </button>
            </div>
            <div class="aside-left-list">
                <ul>
                    <li>
                        <a href="{:url('email/index',['type'=>0])}" style="padding-top: 5px">
                            <span class="iconfont" style="font-size: 18px;font-weight: 700;">&#xe628;</span>
                            <span style="color:#82939E ;">内部收件箱</span>
                        </a>
                    </li>
                    <li>
                        <a href="{:url('email/index',['type'=>1])}" style="padding-top: 3px">
                            <span class="iconfont" style="font-size: 20px;font-weight: 700;">&#xe60d;</span>
                            <span style="color:#82939E ;">代办邮件</span>
                        </a>
                    </li>
                    <li>
                        <a href="{:url('email/index',['type'=>2])}" style="padding-top: 5px">
                            <span class="iconfont" style="font-size:18px;font-weight: 700;">&#xe695;</span>
                            <span style="color:#82939E ;">草稿箱</span>
                        </a>
                    </li>
                    <li>
                        <a href="{:url('email/index',['type'=>3])}" style="padding: 3px 0 0 17px">
                            <span class="iconfont" style="font-size: 20px;">&#xe6e1;</span>
                            <span style="color:#82939E ;">已发送</span>
                        </a>
                    </li>
                    <li>
                        <a href="{:url('email/index',['type'=>4])}" style="padding-top: 5px">
                            <span class="iconfont" style="font-size: 18px;">&#xe61b;</span>
                            <span style="color:#82939E ;">已删除</span>
                        </a>
                    </li>
                </ul>
            </div>
            <div class="aside-left-bottom">
                <section data-am-widget="accordion" class="am-accordion am-accordion-basic" data-am-accordion='{  }'>
                    <dl class="am-accordion-item am-active">
                        <dt class="am-accordion-title" style="padding: 0 0 0 15px;font-size: 20px;;">
                            <span style="font-size: 14px"> 我的文件夹</span>
                            <a class="iconfont dialog-show">&#xe604;</a>
                        </dt>
                    </dl>
                </section>
            </div>
        </div>
        <div class="aside-right">
            <form action="{:url('')}" method="post" enctype="multipart/form-data" id="mail_submit_form" >
                <input type="hidden" name="mail_status" value="" id="email_go">
                <input type="hidden" name="mail_id" value="{$info.mail_id}">
                <div class="aside-right-top">
                    <a href="{:url('email/index')}">
                        <button type="button" class="btn-back">返回</button>
                    </a>
                    <button type="button" class="btn-draft">存草稿</button>
                    <button type="submit" class="am-btn am-btn-primary email-to">发送</button>
                </div>
                <div class="panel">
                    <div class="control-group">
                        <div class="recipient">
                            收件人
                        </div>
                        <div class="control-sel">
                            <!--select插件-->
                            <div style="float: left; width:555px;position: relative">
                                <input type="hidden" name="mail_receive" id="mail_receive" value="{$info.mail_receive}"/>
                                <div id="out_box_left" class="out-box out-box-left">
                                    <ul class="tag-box sel-btn">
                                    </ul>
                                    <div class="btn-box">
                                        <button type="button" class="man-btn btn iconfont">&#xe632;</button>
                                        <button type="button" class="btn clean-btn iconfont">&#xe62f;</button>
                                    </div>
                                    <ul class="item-box">
                                        <li class="item-title">部门选择</li>
                                        {volist name="publish_scope['depart']" id="vo"}
                                        <li class="item" data-value="d_{$vo.id}">{$vo.title}</li>
                                        {/volist}
                                        <li class="item-title">岗位选择</li>
                                        {volist name="publish_scope['station']" id="vo"}
                                        <li class="item" data-value="s_{$vo.id}">{$vo.title}</li>
                                        {/volist}
                                        <li class="item-title">角色选择</li>
                                        {volist name="publish_scope['role']" id="vo"}
                                        <li class="item" data-value="r_{$vo.id}">{$vo.title}</li>
                                        {/volist}
                                    </ul>
                                    <!--弹出表单-->
                                    <div class="select-user-box">
                                        <!--表单头部-->
                                        <div class="select-box-header">
                                            <ul class="select-box-nav">
                                                <li data-type="department" class="active">
                                                    <a href="javascript:;">
                                                        <i class="iconfont" style="font-size: 30px">&#xe630;</i>
                                                        <span>按部门</span>
                                                    </a>
                                                </li>
                                                <li data-type="position">
                                                    <a href="javascript:;">
                                                        <i class="iconfont" style="font-size: 30px">&#xe75a;</i>
                                                        <span>按岗位</span>
                                                    </a>
                                                </li>
                                                <li data-type="role">
                                                    <a href="javascript:;">
                                                        <i class="iconfont" style="font-size: 30px">&#xe63f;</i>
                                                        <span>按角色</span>
                                                    </a>
                                                </li>
                                            </ul>
                                        </div>
                                        <div class="select-all">
                                            <!--按部门-->
                                            <div class="department select-user-content">
                                                <!--部门左边-->
                                                <div class="select-box-inner">
                                                    <ul class="inner-ul depart-inner-ul">
                                                        {volist name="publish_scope['depart']" id="vo" empty="无"}
                                                        <li style="position: relative">
                                                            <a>
                                                        <span class="iconfont"
                                                              style="color: #82939E; font-size: 14px;display: inline-block;width:18px;margin-left:5px;">&#xe747;</span>
                                                        <span class="select-a-span depart_item" data-id="{$vo.id}"
                                                              data-title="{$vo.title}">{$vo.title}</span>
                                                                <input type="checkbox" class="item2"
                                                                       data-id="d_{$vo.id}" data-title="{$vo.title}"
                                                                       style="position: absolute;right: 24px;width: 20px;height: 20px;">
                                                            </a>
                                                        </li>
                                                        {/volist}
                                                    </ul>
                                                </div>
                                                <!--部门右边-->
                                                <div class="select-box-side">
                                                    <div class="select-box-side-content">
                                                        {volist name="publish_scope['depart']" id="vo"}
                                                        <ul style="width: 155px;padding: 5px 8px;display: none;"
                                                            class="depart-aside-ul depart_ul" data-pid="{$vo.id}">
                                                            <div class="select-box-side-header">
                                                                <span>选择全部</span>
                                                                <input type="checkbox" class="click-all check_all_depart"
                                                                       data-pid="d_{$vo.id}"/>
                                                            </div>
                                                            {present name="vo.user"}
                                                            {volist name="vo.user" id="va"}
                                                            <li>
                                                                <span class="iconfont">&#xe6ae;</span>
                                                        <span style="font-size: 12px;margin-top: -3px;"
                                                              class="select-name ">{$va.user_real_name}</span>
                                                                <input type="checkbox" class="item2 checkboxs depart_user_item"
                                                                       data-id="u_{$va.user_id}" data-pid="d_{$vo.id}"
                                                                       data-title="{$va.user_real_name}"/>
                                                            </li>
                                                            {/volist}
                                                            {/present}
                                                        </ul>
                                                        {/volist}
                                                    </div>
                                                </div>
                                            </div>
                                            <!--按岗位-->
                                            <div class="position select-user-content ">
                                                <!--岗位左边-->
                                                <div class="select-box-inner ">
                                                    <ul class="inner-ul ">
                                                        <li>
                                                            <a>
                                                        <span class="iconfont"
                                                              style="color: #82939E; font-size: 20px;display: inline-block;width:18px;margin-left:5px; ">&#xe7a0;</span>
                                                        <span style="color:#82939E; display: inline-block; width: 100px;height: 25px;font-size: 12px;border:solid 1px #f9fbff;border-radius: 4px;font-weight: 500; "
                                                              class="select-a-span ">默认分类</span>
                                                            </a>
                                                        </li>
                                                        {volist name="publish_scope['station']" id="vo"}
                                                        <li style="padding-left: 20px;margin-top: 5px;height: 20px; position: relative">
                                                            <a>
                                                        <span class="iconfont "
                                                              style="color: #82939E; font-size: 16px;display: inline-block;width:18px;margin-left:5px; ">&#xe747;</span>
                                                        <span class="select-a-span station_item" data-id="{$vo.id}"
                                                              data-title="{$vo.title}">{$vo.title}</span>
                                                                <input type="checkbox" class="item2"
                                                                       data-id="s_{$vo.id}" data-title="{$vo.title}"
                                                                       style="position: absolute;right: 24px;width: 20px;height: 20px;">
                                                            </a>
                                                        </li>
                                                        {/volist}
                                                    </ul>
                                                </div>
                                                <!--岗位右边-->
                                                <div class="select-box-side ">
                                                    <div class="select-box-side-content ">
                                                        {volist name="publish_scope['station']" id="vo"}
                                                        <ul style="width: 155px;padding: 5px 8px; display: none "
                                                            class="station-aside-ul">
                                                            <div class="select-box-side-header">
                                                                <span>选择全部</span>
                                                                <input type="checkbox" class="click-all check_all_depart"
                                                                       data-pid="s_{$vo.id}"/>
                                                            </div>
                                                            {present name="vo.user"}
                                                            {volist name="vo.user" id="va"}
                                                            <li>
                                                                <span class="iconfont ">&#xe6ae;</span>
                                                        <span style="font-size: 12px; "
                                                              class="select-name station_user_item"
                                                              data-id="{$va.user_id}"
                                                              data-pid="{$vo.id}" data-title="{$va.user_real_name}">{$va.user_real_name}</span>
                                                                <input type="checkbox" name="check" class="item2 checkboxs"
                                                                       data-id="u_{$va.user_id}" data-pid="s_{$vo.id}"
                                                                       data-title="{$va.user_real_name}"/>
                                                            </li>
                                                            {/volist}
                                                            {/present}
                                                        </ul>
                                                        {/volist}
                                                    </div>
                                                </div>
                                            </div>
                                            <!--按角色-->
                                            <div class="role select-user-content ">
                                                <!--角色左边-->
                                                <div class="select-box-inner ">
                                                    <ul class="inner-ul ">
                                                        {volist name="publish_scope['role']" id="vo"}
                                                        <li style="position: relative">
                                                            <a>
                                                        <span class="iconfont "
                                                              style="color: #82939E; font-size: 14px;display: inline-block;width:18px;margin-left:5px; ">&#xe747;</span>
                                                        <span class="select-a-span role_item" data-id="{$vo.id}"
                                                              data-title="{$vo.title}">{$vo.title}</span>
                                                                <input type="checkbox" class="item2"
                                                                       data-id="r_{$vo.id}"
                                                                       data-title="{$vo.title}"
                                                                       style="position: absolute;right: 24px;width: 20px;height: 20px;">
                                                            </a>
                                                        </li>
                                                        {/volist}
                                                    </ul>
                                                </div>
                                                <!--角色右边-->
                                                <div class="select-box-side ">
                                                    <div class="select-box-side-content ">
                                                        {volist name="publish_scope['role']" id="vo"}
                                                        <ul style="display: none" class="role-aside-ul">
                                                            <div class="select-box-side-header">
                                                                <span>选择全部</span>
                                                                <input type="checkbox" class="click-all check_all_depart"
                                                                       data-pid="r_{$vo.id}"/>
                                                            </div>
                                                            {present name="vo.user"}
                                                            {volist name="vo.user" id="va"}
                                                            <li>
                                                                <span class="iconfont ">&#xe6ae;</span>
                                                        <span style="font-size: 12px; "
                                                              class="select-name role_user_item"
                                                              data-id="{$va.user_id}" data-pid="{$vo.id}"
                                                              data-title="{$va.user_real_name}">{$va.user_real_name}</span>
                                                                <input type="checkbox" name="check" class="item2 checkboxs"
                                                                       data-id="u_{$va.user_id}" data-pid="r_{$vo.id}"
                                                                       data-title="{$va.user_real_name}"/>
                                                            </li>
                                                            {/volist}
                                                            {/present}
                                                        </ul>
                                                        {/volist}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                    <div class="control-group">
                        <div class="control-sel">
                            <button class="cc-btn" type="button">抄送/密送</button>
                        </div>
                    </div>

                    <div class="cc-box" style="display: none">
                        <div>
                            <div class="cc-man" style="font-size: 14px">
                                抄送
                            </div>
                            <!--select插件-->
                            <div style="float:right; width:555px;position: relative">
                                <input type="hidden" name="mail_cc" id="mail_cc" value="{$info.mail_cc}"/>
                                <div id="out_box_right" class="out-box out-box-left">
                                    <ul class="tag-box sel-btn">
                                    </ul>
                                    <div class="btn-box">
                                        <button type="button" class="man-btn btn iconfont">&#xe632;</button>
                                        <button type="button" class="btn clean-btn iconfont">&#xe62f;</button>
                                    </div>
                                    <ul class="item-box">
                                        <li class="item-title">部门选择</li>
                                        {volist name="publish_scope['depart']" id="vo"}
                                        <li class="item" data-value="d_{$vo.id}">{$vo.title}</li>
                                        {/volist}
                                        <li class="item-title">岗位选择</li>
                                        {volist name="publish_scope['station']" id="vo"}
                                        <li class="item" data-value="s_{$vo.id}">{$vo.title}</li>
                                        {/volist}
                                        <li class="item-title">角色选择</li>
                                        {volist name="publish_scope['role']" id="vo"}
                                        <li class="item" data-value="r_{$vo.id}">{$vo.title}</li>
                                        {/volist}
                                    </ul>
                                    <!--弹出表单-->
                                    <div class="select-user-box">
                                        <!--表单头部-->
                                        <div class="select-box-header">
                                            <ul class="select-box-nav">
                                                <li data-type="department" class="active">
                                                    <a href="javascript:;">
                                                        <i class="iconfont" style="font-size: 30px">&#xe630;</i>
                                                        <span>按部门</span>
                                                    </a>
                                                </li>
                                                <li data-type="position">
                                                    <a href="javascript:;">
                                                        <i class="iconfont" style="font-size: 30px">&#xe75a;</i>
                                                        <span>按岗位</span>
                                                    </a>
                                                </li>
                                                <li data-type="role">
                                                    <a href="javascript:;">
                                                        <i class="iconfont" style="font-size: 30px">&#xe63f;</i>
                                                        <span>按角色</span>
                                                    </a>
                                                </li>
                                            </ul>
                                        </div>
                                        <div class="select-all">
                                            <!--按部门-->
                                            <div class="department select-user-content">
                                                <!--部门左边-->
                                                <div class="select-box-inner">
                                                    <ul class="inner-ul depart-inner-ul">
                                                        {volist name="publish_scope['depart']" id="vo" empty="无"}
                                                        <li style="position: relative">
                                                            <a>
                                                        <span class="iconfont"
                                                              style="color: #82939E; font-size: 14px;display: inline-block;width:18px;margin-left:5px;">&#xe747;</span>
                                                        <span class="select-a-span depart_item" data-id="{$vo.id}"
                                                              data-title="{$vo.title}">{$vo.title}</span>
                                                                <input type="checkbox" class="item2"
                                                                       data-id="d_{$vo.id}" data-title="{$vo.title}"
                                                                       style="position: absolute;right: 24px;width: 20px;height: 20px;">
                                                            </a>
                                                        </li>
                                                        {/volist}
                                                    </ul>
                                                </div>
                                                <!--部门右边-->
                                                <div class="select-box-side">
                                                    <div class="select-box-side-content">
                                                        {volist name="publish_scope['depart']" id="vo"}
                                                        <ul style="width: 155px;padding: 5px 8px;display: none;"
                                                            class="depart-aside-ul depart_ul" data-pid="{$vo.id}">
                                                            <div class="select-box-side-header">
                                                                <span>选择全部</span>
                                                                <input type="checkbox" class="click-all check_all_depart"
                                                                       data-pid="d_{$vo.id}"/>
                                                            </div>
                                                            {present name="vo.user"}
                                                            {volist name="vo.user" id="va"}
                                                            <li>
                                                                <span class="iconfont">&#xe6ae;</span>
                                                        <span style="font-size: 12px;margin-top: -3px;"
                                                              class="select-name ">{$va.user_real_name}</span>
                                                                <input type="checkbox" class="item2 checkboxs depart_user_item"
                                                                       data-id="u_{$va.user_id}" data-pid="d_{$vo.id}"
                                                                       data-title="{$va.user_real_name}"/>
                                                            </li>
                                                            {/volist}
                                                            {/present}
                                                        </ul>
                                                        {/volist}
                                                    </div>
                                                </div>
                                            </div>
                                            <!--按岗位-->
                                            <div class="position select-user-content ">
                                                <!--岗位左边-->
                                                <div class="select-box-inner ">
                                                    <ul class="inner-ul ">
                                                        <li>
                                                            <a>
                                                        <span class="iconfont"
                                                              style="color: #82939E; font-size: 20px;display: inline-block;width:18px;margin-left:5px; ">&#xe7a0;</span>
                                                        <span style="color:#82939E; display: inline-block; width: 100px;height: 25px;font-size: 12px;border:solid 1px #f9fbff;border-radius: 4px;font-weight: 500; "
                                                              class="select-a-span ">默认分类</span>
                                                            </a>
                                                        </li>
                                                        {volist name="publish_scope['station']" id="vo"}
                                                        <li style="padding-left: 20px;margin-top: 5px;height: 20px; position: relative">
                                                            <a>
                                                        <span class="iconfont "
                                                              style="color: #82939E; font-size: 16px;display: inline-block;width:18px;margin-left:5px; ">&#xe747;</span>
                                                        <span class="select-a-span station_item" data-id="{$vo.id}"
                                                              data-title="{$vo.title}">{$vo.title}</span>
                                                                <input type="checkbox" class="item2"
                                                                       data-id="s_{$vo.id}" data-title="{$vo.title}"
                                                                       style="position: absolute;right: 24px;width: 20px;height: 20px;">
                                                            </a>
                                                        </li>
                                                        {/volist}
                                                    </ul>
                                                </div>
                                                <!--岗位右边-->
                                                <div class="select-box-side ">
                                                    <div class="select-box-side-content ">
                                                        {volist name="publish_scope['station']" id="vo"}
                                                        <ul style="width: 155px;padding: 5px 8px; display: none "
                                                            class="station-aside-ul">
                                                            <div class="select-box-side-header">
                                                                <span>选择全部</span>
                                                                <input type="checkbox" class="click-all check_all_depart"
                                                                       data-pid="s_{$vo.id}"/>
                                                            </div>
                                                            {present name="vo.user"}
                                                            {volist name="vo.user" id="va"}
                                                            <li>
                                                                <span class="iconfont ">&#xe6ae;</span>
                                                        <span style="font-size: 12px; "
                                                              class="select-name station_user_item"
                                                              data-id="{$va.user_id}"
                                                              data-pid="{$vo.id}" data-title="{$va.user_real_name}">{$va.user_real_name}</span>
                                                                <input type="checkbox" name="check" class="item2 checkboxs"
                                                                       data-id="u_{$va.user_id}" data-pid="s_{$vo.id}"
                                                                       data-title="{$va.user_real_name}"/>
                                                            </li>
                                                            {/volist}
                                                            {/present}
                                                        </ul>
                                                        {/volist}
                                                    </div>
                                                </div>
                                            </div>
                                            <!--按角色-->
                                            <div class="role select-user-content ">
                                                <!--角色左边-->
                                                <div class="select-box-inner ">
                                                    <ul class="inner-ul ">
                                                        {volist name="publish_scope['role']" id="vo"}
                                                        <li style="position: relative">
                                                            <a>
                                                        <span class="iconfont "
                                                              style="color: #82939E; font-size: 14px;display: inline-block;width:18px;margin-left:5px; ">&#xe747;</span>
                                                        <span class="select-a-span role_item" data-id="{$vo.id}"
                                                              data-title="{$vo.title}">{$vo.title}</span>
                                                                <input type="checkbox" class="item2"
                                                                       data-id="r_{$vo.id}"
                                                                       data-title="{$vo.title}"
                                                                       style="position: absolute;right: 24px;width: 20px;height: 20px;">
                                                            </a>
                                                        </li>
                                                        {/volist}
                                                    </ul>
                                                </div>
                                                <!--角色右边-->
                                                <div class="select-box-side ">
                                                    <div class="select-box-side-content ">
                                                        {volist name="publish_scope['role']" id="vo"}
                                                        <ul style="display: none" class="role-aside-ul">
                                                            <div class="select-box-side-header">
                                                                <span>选择全部</span>
                                                                <input type="checkbox" class="click-all check_all_depart"
                                                                       data-pid="r_{$vo.id}"/>
                                                            </div>
                                                            {present name="vo.user"}
                                                            {volist name="vo.user" id="va"}
                                                            <li>
                                                                <span class="iconfont ">&#xe6ae;</span>
                                                        <span style="font-size: 12px; "
                                                              class="select-name role_user_item"
                                                              data-id="{$va.user_id}" data-pid="{$vo.id}"
                                                              data-title="{$va.user_real_name}">{$va.user_real_name}</span>
                                                                <input type="checkbox" name="check" class="item2 checkboxs"
                                                                       data-id="u_{$va.user_id}" data-pid="r_{$vo.id}"
                                                                       data-title="{$va.user_real_name}"/>
                                                            </li>
                                                            {/volist}
                                                            {/present}
                                                        </ul>
                                                        {/volist}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div style="clear: both"></div>
                        </div>

                        <div>
                            <div class="cc-man" style="font-size: 14px">
                                密送
                            </div>
                            <div style="float:right; width:555px;position: relative">
                                <input type="hidden" name="mail_s_cc" id="mail_s_cc" value="{$info.mail_s_cc}"/>
                                <div id="out_box_bottom" class="out-box out-box-left">
                                    <ul class="tag-box sel-btn">
                                    </ul>
                                    <div class="btn-box">
                                        <button type="button" class="man-btn btn iconfont">&#xe632;</button>
                                        <button type="button" class="btn clean-btn iconfont">&#xe62f;</button>
                                    </div>
                                    <ul class="item-box">
                                        <li class="item-title">部门选择</li>
                                        {volist name="publish_scope['depart']" id="vo"}
                                        <li class="item" data-value="d_{$vo.id}">{$vo.title}</li>
                                        {/volist}
                                        <li class="item-title">岗位选择</li>
                                        {volist name="publish_scope['station']" id="vo"}
                                        <li class="item" data-value="s_{$vo.id}">{$vo.title}</li>
                                        {/volist}
                                        <li class="item-title">角色选择</li>
                                        {volist name="publish_scope['role']" id="vo"}
                                        <li class="item" data-value="r_{$vo.id}">{$vo.title}</li>
                                        {/volist}
                                    </ul>
                                    <!--弹出表单-->
                                    <div class="select-user-box">
                                        <!--表单头部-->
                                        <div class="select-box-header">
                                            <ul class="select-box-nav">
                                                <li data-type="department" class="active">
                                                    <a href="javascript:;">
                                                        <i class="iconfont" style="font-size: 30px">&#xe630;</i>
                                                        <span>按部门</span>
                                                    </a>
                                                </li>
                                                <li data-type="position">
                                                    <a href="javascript:;">
                                                        <i class="iconfont" style="font-size: 30px">&#xe75a;</i>
                                                        <span>按岗位</span>
                                                    </a>
                                                </li>
                                                <li data-type="role">
                                                    <a href="javascript:;">
                                                        <i class="iconfont" style="font-size: 30px">&#xe63f;</i>
                                                        <span>按角色</span>
                                                    </a>
                                                </li>
                                            </ul>
                                        </div>
                                        <div class="select-all">
                                            <!--按部门-->
                                            <div class="department select-user-content">
                                                <!--部门左边-->
                                                <div class="select-box-inner">
                                                    <ul class="inner-ul depart-inner-ul">
                                                        {volist name="publish_scope['depart']" id="vo" empty="无"}
                                                        <li style="position: relative">
                                                            <a>
                                                        <span class="iconfont"
                                                              style="color: #82939E; font-size: 14px;display: inline-block;width:18px;margin-left:5px;">&#xe747;</span>
                                                        <span class="select-a-span depart_item" data-id="{$vo.id}"
                                                              data-title="{$vo.title}">{$vo.title}</span>
                                                                <input type="checkbox" class="item2"
                                                                       data-id="d_{$vo.id}" data-title="{$vo.title}"
                                                                       style="position: absolute;right: 24px;width: 20px;height: 20px;">
                                                            </a>
                                                        </li>
                                                        {/volist}
                                                    </ul>
                                                </div>
                                                <!--部门右边-->
                                                <div class="select-box-side">
                                                    <div class="select-box-side-content">
                                                        {volist name="publish_scope['depart']" id="vo"}
                                                        <ul style="width: 155px;padding: 5px 8px;display: none;"
                                                            class="depart-aside-ul depart_ul" data-pid="{$vo.id}">
                                                            <div class="select-box-side-header">
                                                                <span>选择全部</span>
                                                                <input type="checkbox" class="click-all check_all_depart"
                                                                       data-pid="d_{$vo.id}"/>
                                                            </div>
                                                            {present name="vo.user"}
                                                            {volist name="vo.user" id="va"}
                                                            <li>
                                                                <span class="iconfont">&#xe6ae;</span>
                                                        <span style="font-size: 12px;margin-top: -3px;"
                                                              class="select-name ">{$va.user_real_name}</span>
                                                                <input type="checkbox" class="item2 checkboxs depart_user_item"
                                                                       data-id="u_{$va.user_id}" data-pid="d_{$vo.id}"
                                                                       data-title="{$va.user_real_name}"/>
                                                            </li>
                                                            {/volist}
                                                            {/present}
                                                        </ul>
                                                        {/volist}
                                                    </div>
                                                </div>
                                            </div>
                                            <!--按岗位-->
                                            <div class="position select-user-content ">
                                                <!--岗位左边-->
                                                <div class="select-box-inner ">
                                                    <ul class="inner-ul ">
                                                        <li>
                                                            <a>
                                                        <span class="iconfont"
                                                              style="color: #82939E; font-size: 20px;display: inline-block;width:18px;margin-left:5px; ">&#xe7a0;</span>
                                                        <span style="color:#82939E; display: inline-block; width: 100px;height: 25px;font-size: 12px;border:solid 1px #f9fbff;border-radius: 4px;font-weight: 500; "
                                                              class="select-a-span ">默认分类</span>
                                                            </a>
                                                        </li>
                                                        {volist name="publish_scope['station']" id="vo"}
                                                        <li style="padding-left: 20px;margin-top: 5px;height: 20px; position: relative">
                                                            <a>
                                                        <span class="iconfont "
                                                              style="color: #82939E; font-size: 16px;display: inline-block;width:18px;margin-left:5px; ">&#xe747;</span>
                                                        <span class="select-a-span station_item" data-id="{$vo.id}"
                                                              data-title="{$vo.title}">{$vo.title}</span>
                                                                <input type="checkbox" class="item2"
                                                                       data-id="s_{$vo.id}" data-title="{$vo.title}"
                                                                       style="position: absolute;right: 24px;width: 20px;height: 20px;">
                                                            </a>
                                                        </li>
                                                        {/volist}
                                                    </ul>
                                                </div>
                                                <!--岗位右边-->
                                                <div class="select-box-side ">
                                                    <div class="select-box-side-content ">
                                                        {volist name="publish_scope['station']" id="vo"}
                                                        <ul style="width: 155px;padding: 5px 8px; display: none "
                                                            class="station-aside-ul">
                                                            <div class="select-box-side-header">
                                                                <span>选择全部</span>
                                                                <input type="checkbox" class="click-all check_all_depart"
                                                                       data-pid="s_{$vo.id}"/>
                                                            </div>
                                                            {present name="vo.user"}
                                                            {volist name="vo.user" id="va"}
                                                            <li>
                                                                <span class="iconfont ">&#xe6ae;</span>
                                                        <span style="font-size: 12px; "
                                                              class="select-name station_user_item"
                                                              data-id="{$va.user_id}"
                                                              data-pid="{$vo.id}" data-title="{$va.user_real_name}">{$va.user_real_name}</span>
                                                                <input type="checkbox" name="check" class="item2 checkboxs"
                                                                       data-id="u_{$va.user_id}" data-pid="s_{$vo.id}"
                                                                       data-title="{$va.user_real_name}"/>
                                                            </li>
                                                            {/volist}
                                                            {/present}
                                                        </ul>
                                                        {/volist}
                                                    </div>
                                                </div>
                                            </div>
                                            <!--按角色-->
                                            <div class="role select-user-content ">
                                                <!--角色左边-->
                                                <div class="select-box-inner ">
                                                    <ul class="inner-ul ">
                                                        {volist name="publish_scope['role']" id="vo"}
                                                        <li style="position: relative">
                                                            <a>
                                                        <span class="iconfont "
                                                              style="color: #82939E; font-size: 14px;display: inline-block;width:18px;margin-left:5px; ">&#xe747;</span>
                                                        <span class="select-a-span role_item" data-id="{$vo.id}"
                                                              data-title="{$vo.title}">{$vo.title}</span>
                                                                <input type="checkbox" class="item2"
                                                                       data-id="r_{$vo.id}"
                                                                       data-title="{$vo.title}"
                                                                       style="position: absolute;right: 24px;width: 20px;height: 20px;">
                                                            </a>
                                                        </li>
                                                        {/volist}
                                                    </ul>
                                                </div>
                                                <!--角色右边-->
                                                <div class="select-box-side ">
                                                    <div class="select-box-side-content ">
                                                        {volist name="publish_scope['role']" id="vo"}
                                                        <ul style="display: none" class="role-aside-ul">
                                                            <div class="select-box-side-header">
                                                                <span>选择全部</span>
                                                                <input type="checkbox" class="click-all check_all_depart"
                                                                       data-pid="r_{$vo.id}"/>
                                                            </div>
                                                            {present name="vo.user"}
                                                            {volist name="vo.user" id="va"}
                                                            <li>
                                                                <span class="iconfont ">&#xe6ae;</span>
                                                        <span style="font-size: 12px; "
                                                              class="select-name role_user_item"
                                                              data-id="{$va.user_id}" data-pid="{$vo.id}"
                                                              data-title="{$va.user_real_name}">{$va.user_real_name}</span>
                                                                <input type="checkbox" name="check" class="item2 checkboxs"
                                                                       data-id="u_{$va.user_id}" data-pid="r_{$vo.id}"
                                                                       data-title="{$va.user_real_name}"/>
                                                            </li>
                                                            {/volist}
                                                            {/present}
                                                        </ul>
                                                        {/volist}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div style="clear: both"></div>
                        </div>

                    </div>
                    <div class="control-group">
                        <div class="email-kind">
                            <select data-am-selected>
                                {volist name="cate_list" id="vo"}
                                <option value="{$vo.cate_id}">{$vo.cate_title}</option>
                                {/volist}
                            </select>
                        </div>
                        <div class="control-sel">
                            <input type="text" class="email-title" placeholder="请输入邮件主题" name="mail_title" value="{$info.mail_title}">
                        </div>
                    </div>
                </div>
                <!--编辑器-->
                <div class="edit-content" style="margin-top: -20px;">
                    <script style="display: inline-block;" id="doc_content" name="mail_content">
                        {$info.mail_content}
                    </script>
                </div>
                <div class="aside-right-bottom">
                    <a href="{:url('email/index')}">
                        <button type="button" class="btn-back bottom-btn-back">返回</button>
                    </a>
                    <button type="button" class="btn-draft bottom-btn-draft">存草稿</button>
                    <button type="submit" class="am-btn am-btn-primary bottom-btn-primary email-to">发送</button>
                </div>
            </form>
            <!--上传附件的插件-->
            <form id="post-form" class="file-form" name="fileform">
                <div class="file-box am-form-group am-form-file">
                    <button type="button" class="am-btn am-btn-default am-btn-sm" style="border-radius: 4px;">
                        <i class="am-icon-cloud-upload"></i>上传附件
                    </button>
                    <input id="fileinput" type="file" name="file">
                </div>
                <div id="file_msg" class="file-msg">
                    {$info.mail_annex}
                </div>
            </form>
            <!--弹出框-->
            <div id="dialog" class="dialog-none">
                <div class="dialog-title">
                    <span>我的文件夹设置</span>
                    <a href="" class="dialog-close"><span class="iconfont" style="font-size: 16px;">&#xe617;</span></a>
                </div>
                <table class="am-table" id="dialog-table">
                    <thead>
                    <tr>
                        <th>序号</th>
                        <th>名称</th>
                        <th>占用空间</th>
                        <th>操作</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr class="th-backgroud">
                        <th></th>
                        <th>内部收件箱</th>
                        <th>0 Bytes</th>
                        <th></th>
                    </tr>
                    <tr>
                        <th></th>
                        <th>外部收件箱</th>
                        <th>0 Bytes</th>
                        <th></th>
                    </tr>
                    <tr class="th-backgroud">
                        <th></th>
                        <th>已发送邮件箱</th>
                        <th>133.13 KB</th>
                        <th></th>
                    </tr>
                    <tr>
                        <th></th>
                        <th>垃圾箱</th>
                        <th>4.61 KB</th>
                        <th></th>
                    </tr>
                    </tbody>
                </table>
                <div id="" class="th-ga">
                    <table class="am-table" id="dialog-table2">
                        <tr>
                            <th style="width: 60px; border-bottom: 1px solid #e0e0de;"><input type="text" class="th-input" /></th>
                            <th style="width: 398px;border-bottom: 1px solid #e0e0de;"><input type="" name="" id="input-folder-name" value="" placeholder="请填写文件夹名称" /></th>
                            <th style="width: 60px;border-bottom: 1px solid #e0e0de;"><button type="button" class="am-btn am-btn-primary button-add">添加</button></th>
                        </tr>
                        <tr style="border-top: solid 1px yellowgreen !important;">
                            <th style="width: 60px;"></th>
                            <th style="width: 398px; height:46px;padding-left: 30px; ">
                                <span style="font-weight: 700;">您的邮箱容量为5000M,当前已用：</span>
                                <strong style="color: #EE8C0C;">137.75 KB</strong>
                            </th>
                            <th></th>
                        </tr>
                    </table>
                </div>
                <div class="dialog-bottom">
                    <button type="button" class="am-btn" id="dialog-bottom-button">关闭</button>
                </div>
            </div>
        </div>
        <div style="clear: both;"></div>
    </div>
    <div class="ibcontainer_footer">
        <div class="footer">
            <a href="{:url('index/index')}"><i class="footer-logo"></i></a>
            <a href="">个人办公</a>
            <a href="{:url('email/index')}">邮件中心</a>
            <a href="">填写邮件</a>
        </div>
    </div>
</div>
<!-- 编辑器源码文件 -->
<script type="text/javascript" src="/resource/ueditor1.4.3.3/ueditor.config.js"></script>
<script type="text/javascript" src="/resource/ueditor1.4.3.3/ueditor.all.js"></script>
<script>
    //把邮件=>草稿箱
    $(".btn-draft").click(function(){
        $("#email_go").val(2);
        $("#mail_submit_form").submit();
    });
    $(".email-to").click(function(){
        $("#email_go").val(1);
        $("#mail_submit_form").submit();
    });


    var annex_index = 0;//附件索引
    var ue = UE.getEditor('doc_content',{
        serverUrl:'{:url("base/base/ue_upload")}',
        initialFrameWidth :740,
        initialFrameHeight:340,
        autoHeightEnabled:false

    });

    function Sel(out_box_id) {
        this.$out_box = $('#' + out_box_id);
        this.$tag_box = this.$out_box.children('.tag-box').eq(0);
        this.$tag_del = this.$tag_box.find('.tag-del');
        this.$item_box = this.$out_box.children('.item-box').eq(0);
        this.$item = this.$item_box.children('.item');
        this.$sel_box = this.$out_box.children('.select-user-box').eq(0);
        this.$item2 = this.$sel_box.find('.item2');
        this.$click_all = this.$sel_box.find('.click-all');
        this.$btn_box = this.$out_box.children('.btn-box').eq(0);
        this.$sel_btn = this.$out_box;
        this.$man_btn = this.$btn_box.children('.man-btn').eq(0);
        this.$clean_btn = this.$btn_box.children('.clean-btn').eq(0);
        this.tag_arr = [];
        var _this = this;
        this.selBtnClick(this.$sel_btn, _this);
        this.manBtnClick(this.$man_btn, _this);
        this.cleanBtnClick(this.$clean_btn, _this);
        this.selBoxClick(this.$sel_box);
        this.itemClick(this.$item, _this);
        this.item2Click(this.$item2, _this);
        this.allClick(this.$click_all, _this);
    }
    Sel.prototype.selBtnClick = function (elem, _this){
        elem.click(function (event){
            var $ib = _this.$item_box;
            if($ib.css('display') == 'none'){
                console.log('item show');
                _this.hideBox('sel_box');
                $ib.css('display', 'block');
            } else{
                console.log('item hide');
                $ib.css('display', 'none');
            }
            event.stopPropagation();
        });
    }
    Sel.prototype.manBtnClick = function (elem, _this){
        elem.click(function (event){
            _this.hideBox('item_box');
            var $sb = _this.$sel_box;
            if($sb.css('display') == 'block'){
                console.log('sel hide');
                $sb.css('display', 'none');
            } else{
                console.log('sel show');
                $sb.css('display', 'block');
            }
            event.stopPropagation();
        });
    }
    Sel.prototype.cleanBtnClick = function (elem, _this){
        elem.click(function (event){
            console.log('clean');
            _this.$item2.each(function (){
                if($(this).prop('checked') == true){
                    $(this).click();
                }
            });
            _this.$click_all.each(function (){
                if($(this).prop('checked') == true){
                    $(this).prop('checked', false);
                }
            });
            _this.change();
            event.stopPropagation();
        });
    }
    Sel.prototype.selBoxClick = function (elem){
        elem.click(function (event){
            event.stopPropagation();
        });
    }
    Sel.prototype.itemClick = function (elem, _this){
        elem.each(function (){
            $(this).click(function (event){
                var value = $(this).data('value');
                var $item2 = _this.$item2;
                $item2.each(function (){
                    if($(this).data('id') == value){
                        $(this).click();
                        return false;
                    }
                });
                event.stopPropagation();
            });
        });
    }
    Sel.prototype.item2Click = function (elem, _this){
        elem.each(function (){
            $(this).click(function (event){
                var value = $(this).data('id');
                var html = $(this).data('title');
                if($(this).prop('checked') == false){
                    var $item = _this.$item;
                    $item.each(function (){
                        if($(this).data('value') == value){
                            $(this).removeClass('item-selected');
                        }
                    });
                    var $item2 = _this.$item2;
                    $item2.each(function (){
                        if($(this).data('id') == value && $(this).prop('checked') == true){
                            $(this).prop('checked', false);
                        }
                    });
                    var $tag = _this.$tag_box.children();
                    $tag.each(function (){
                        if($(this).data('value') == value){
                            $(this).remove();
                        }
                    });
                    var ta = _this.tag_arr;
                    for(var i in ta){
                        if(ta[i] == value){
                            _this.tag_arr.splice(i, 1);
                        }
                    }
                } else{
                    var $item = _this.$item;
                    $item.each(function (){
                        if($(this).data('value') == value){
                            $(this).addClass('item-selected');
                        }
                    });
                    var $item2 = _this.$item2;
                    $item2.each(function (){
                        if($(this).data('id') == value && $(this).prop('checked') == false){
                            $(this).prop('checked', true);
                        }
                    });
                    var $tag = $('<li class="tag" data-value="' + value + '">' + html + '<span class="tag-del">X</span></li>');
                    _this.$tag_box.append($tag);
                    _this.tag_arr.push(value);
                    _this.$tag_del = _this.$tag_box.find('.tag-del');
                    _this.tagDelClick(_this.$tag_del, _this);
                }
                _this.change();
                event.stopPropagation();
            });
        });
    }
    Sel.prototype.allClick = function (elem, _this){
        elem.each(function (){
            $(this).click(function (){
                var pid = $(this).data('pid');
                if($(this).prop('checked') == true){
                    _this.$item2.each(function (){
                        if($(this).data('pid') == pid && $(this).prop('checked') == false){
                            $(this).click();
                        }
                    });
                } else{
                    _this.$item2.each(function (){
                        if($(this).data('pid') == pid && $(this).prop('checked') == true){
                            $(this).click();
                        }
                    });
                }
            });
        });
    }
    Sel.prototype.tagDelClick = function (elem, _this){
        elem.each(function (){
            console.log('tagDelClick');
            $(this).get(0).onclick = function (event){
                var $tag = $(this).closest('.tag');
                var value = $tag.data('value');
                _this.$item2.each(function (){
                    if($(this).data('id') == value){
                        $(this).click();
                        return false;
                    }
                });
//                _this.change();
                var e = window.event || event;
                if(e.stopPropagation){
                    e.stopPropagation();
                } else{
                    window.event.cancelBubble = true;
                }
            };
        });
    }
    Sel.prototype.hideBox = function (status){
        if(status == undefined){ status = 'item_box';}
        switch (status){
            case 'item_box':
                this.$item_box.css('display', 'none');
                break;
            case 'sel_box':
                this.$sel_box.css('display', 'none');
                break;
            case 'all':
                this.$item_box.css('display', 'none');
                this.$sel_box.css('display', 'none');
                break;
        }
    }
    Sel.prototype.getTagArr = function (){
        return this.tag_arr;
    }
    Sel.prototype.changeFunc = function (func){
        if(typeof func == 'function'){
            this.changeFunc = func;
        }
    }
    Sel.prototype.change = function (){
        this.changeFunc(this.getTagArr());
    }
    $(function (){
        var sel0 = new Sel('out_box_left');
        var sel1 = new Sel('out_box_right');
        var sel2 = new Sel('out_box_bottom');
        $('body').click(function (event){
            sel0.hideBox('all');
            sel1.hideBox('all');
            sel2.hideBox('all');
        });
        sel0.changeFunc(function (arr){
            var str = arr.join(',');
            console.log('sel0:', str);
            $('#mail_receive').attr('value', str);
        });
        sel1.changeFunc(function (arr){
            var str = arr.join(',');
            console.log('sel1:', str);
            $('#mail_cc').attr('value', str);
        });
        sel2.changeFunc(function (arr){
            var str = arr.join(',');
            console.log('sel2:', str);
            $('#mail_s_cc').attr('value', str);
        });

        var $state_box = $('.state-box');
        $state_box.click(function (){
            $state_box.each(function (){
                $(this).removeClass('label-active');
            });
            $(this).addClass('label-active');
        });

        var upsize = 0;
        var uparr = [];
        var fileinput = document.getElementById('fileinput');
        var input_index = 0;
        fileinput.onchange = function (){
            console.log('yuansheng!');
//        $('#fileinput').change(function (){
            console.log('file change');
            var formData = new FormData();
            formData.append('file', $('#fileinput').get(0).files[0]);
//            console.log('formData msg:', formData.get('file'));
//            if(formData.get('file') == 'undefined'){
//                console.log('no file');
//                return;
//            }
//            upsize += parseInt(formData.get('file').size);
//            if(formData.get('file').size > 52400000){
//                alert('文件大小超过50M');
//                return;
//            }
//            if(upsize > 52400000){
//                alert('文件总大小超过50M');
//                return;
//            }
            $.ajax({
                url:"{:url('base/base/upload_files','','',true)}",
                type: 'POST',
                data: formData,
                async: false,
                cache: false,
                contentType: false,
                processData: false,
                success: function (obj){
                    console.log('submit succ', obj);
                    if(obj.state == 1){
                        var annex_file_name = $('<input type="hidden" class="ig' + input_index + '" data-name="obj.data.file_name" data-id="'+annex_index+'"  name="mail_annex['+annex_index+'][file_name]" value="'+obj.data.file_name+'"/>');
                        var annex_file_size = $('<input type="hidden" class="ig' + input_index + '" data-id="'+annex_index+'" name="mail_annex['+annex_index+'][file_size]" value="'+obj.data.file_size+'"/>');
                        var annex_file_url = $('<input type="hidden" class="ig' + input_index + '" data-id="'+annex_index+'"  name="mail_annex['+annex_index+'][file_url]" value="'+obj.data.file+'"/>');
                        var annex_file_type = $('<input type="hidden" class="ig' + input_index + '" data-id="'+annex_index+'" name="mail_annex['+annex_index+'][file_type]" value="'+obj.data.file_type+'"/>');
                        $("#mail_submit_form").append(annex_file_name);
                        $("#mail_submit_form").append(annex_file_size);
                        $("#mail_submit_form").append(annex_file_url);
                        $("#mail_submit_form").append(annex_file_type);
                        upfileShow(obj.data);

                        input_index++;
                        annex_index++;
                    } else{
                        $('#file_msg').html('上传失败');
                    }
                },
                error: function (data) {
                    console.log('submit fail', data);
                    $('#file_msg').html('上传失败');
                }
            });
        };
        function upfileShow(obj){
            var tempobj = {
                'file_name': obj.file_name,
                'file_url': obj.file,
                'size': obj.file_size
            };
            uparr.push(tempobj);
            console.log('uparr:', uparr);
            $('#mail_annex').attr('value', uparr);
            var $file_msg = $('#file_msg');
            var $filetag = $('<div class="file">' + obj.file_name
                    + '<span class="file-del" data-filename="'
                    + obj.file_name + '">删除</span></div>');
            $filetag = fileDelBind($filetag, obj);
            $file_msg.append($filetag);
        }
        function fileDelBind(filetag, obj){
            var $filetag = filetag;
            var $temp = $filetag.children('.file-del');
            $temp.click(function (index){
                var filename = obj.file_name;
                var filesize = obj.file_size;
                for(var i in uparr){
                    if(uparr[i].file_name == filename){
                        uparr.splice(i, 1);
                        console.log('uparr del', uparr);
                    }
                }
                $(this).parent().remove();
                console.log('je:',$(this).parent());
                console.log('input_index:',index);
                $('.ig' + index).remove();
                console.log('filename:',filename);

                upsize -= filesize;
                $('#mail_annex').attr('value', uparr);
            }.bind($temp, input_index));
            return $filetag;
        }


        //人员提取
        var data = '{$info.mail_receive}';
        var cata='{$info.mail_cc}';
        var ccata='{$info.mail_s_cc}';
        var br = data.split(',');
        var cr=cata.split(',');
        var dr=ccata.split(',');
        for(var i=0;i<=br.length;i++){
            $("#out_box_left").find(".select-user-box").find(".item2").each(function(){
                var _this_id=$(this).data("id");
                if(br[i]==_this_id){
                    $(this).click();
                }
            });

        }
        for(var i=0;i<=cr.length;i++){
            $("#out_box_right").find(".select-user-box").find(".item2").each(function(){
                var _this_id=$(this).data("id");
                if(cr[i]==_this_id){
                    $(this).click();
                }
            });
        }
        for(var i=0;i<=cr.length;i++){
            $("#out_box_bottom").find(".select-user-box").find(".item2").each(function(){
                var _this_id=$(this).data("id");
                if(dr[i]==_this_id){
                    $(this).click();
                }
            });
        }

        var tag_li=cata.length;
        if(tag_li>0){
           $(".cc-box").css("display","block")
        }
    });
</script>
</body>

</html>
















